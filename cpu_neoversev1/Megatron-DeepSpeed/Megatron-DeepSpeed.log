VERBOSE: Set messagelevel to: 4
VERBOSE: Starter initialization
VERBOSE: Check if we are running as setuid
VERBOSE: Drop root privileges
VERBOSE: Drop root privileges permanently
VERBOSE: Spawn stage 1
VERBOSE: Execute stage 1
VERBOSE: stage 1 exited with status 0
VERBOSE: Create user namespace
VERBOSE: Create pid namespace
VERBOSE: Spawn master process
VERBOSE: Get root privileges
VERBOSE: Create mount namespace
VERBOSE: Spawn RPC server
VERBOSE: Execute master process
VERBOSE: Serve RPC requests
VERBOSE: rpc server exited with status 0
VERBOSE: Execute stage 2
INFO:    Starting build...
INFO:    Verifying bootstrap image pytorch_2.5.0.sif
WARNING: integrity: signature not found for object group 1
WARNING: Bootstrap image could not be verified, but build will continue.
INFO:    Running setup scriptlet
INFO:    Running post scriptlet
+ . /opt/spack/share/spack/setup-env.sh
++ '[' -n '' ']'
++ export _sp_initializing=true
++ _sp_initializing=true
+++ _spack_determine_shell
+++ '[' -f /proc/354/exe ']'
++++ readlink /proc/354/exe
+++ _sp_exe=/usr/bin/bash
+++ basename /usr/bin/bash
+++ tr -d 0123456789
++ _sp_shell=bash
++ alias 'spacktivate=spack env activate'
++ '[' bash = bash ']'
++ _sp_source_file=/opt/spack/share/spack/setup-env.sh
++ '[' bash = zsh ']'
++++ dirname /opt/spack/share/spack/setup-env.sh
+++ cd /opt/spack/share/spack
+++ pwd
++ _sp_share_dir=/opt/spack/share/spack
+++++ dirname /opt/spack/share/spack
++++ dirname /opt/spack/share
+++ cd /opt/spack
+++ pwd
++ _sp_prefix=/opt/spack
++ '[' -x /opt/spack/bin/spack ']'
++ export SPACK_ROOT=/opt/spack
++ SPACK_ROOT=/opt/spack
++ _spack_pathadd PATH /opt/spack/bin
++ _pa_varname=PATH
++ _pa_new_path=PATH
++ '[' -n /opt/spack/bin ']'
++ _pa_varname=PATH
++ _pa_new_path=/opt/spack/bin
++ eval '_pa_oldvalue=${PATH:-}'
+++ _pa_oldvalue=/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ _pa_canonical=/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:
++ '[' -d /opt/spack/bin ']'
++ '[' /opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin: = /opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin: ']'
++ '[' -n /opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin ']'
++ eval 'export PATH="/opt/spack/bin:/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"'
+++ export PATH=/opt/spack/bin:/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/spack/bin:/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ eval 'spack() {
    : this is a shell function from: /opt/spack/share/spack/setup-env.sh
    : the real spack script is here: /opt/spack/bin/spack
    _spack_shell_wrapper "$@"
    return $?
}'
++ '[' bash = bash ']'
++ export -f spack
++ export -f _spack_shell_wrapper
++ for cmd in "${SPACK_PYTHON:-}" python3 python python2
++ command -v ''
++ for cmd in "${SPACK_PYTHON:-}" python3 python python2
++ command -v python3
+++ command -v python3
++ export SPACK_PYTHON=/usr/bin/python3
++ SPACK_PYTHON=/usr/bin/python3
++ break
++ '[' -z '' ']'
++ need_module=no
++ _spack_fn_exists use
++ LANG=
++ type use
++ grep -q function
++ _spack_fn_exists module
++ LANG=
++ type module
++ grep -q function
++ need_module=yes
++ '[' yes = yes ']'
+++ spack --print-shell-vars sh,modules
+++ : this is a shell function from: /opt/spack/share/spack/setup-env.sh
+++ : the real spack script is here: /opt/spack/bin/spack
+++ _spack_shell_wrapper --print-shell-vars sh,modules
+++ for var in DYLD_LIBRARY_PATH DYLD_FALLBACK_LIBRARY_PATH
+++ eval 'if [ -n "${DYLD_LIBRARY_PATH-}" ]; then export SPACK_DYLD_LIBRARY_PATH=${DYLD_LIBRARY_PATH}; fi'
++++ '[' -n '' ']'
+++ for var in DYLD_LIBRARY_PATH DYLD_FALLBACK_LIBRARY_PATH
+++ eval 'if [ -n "${DYLD_FALLBACK_LIBRARY_PATH-}" ]; then export SPACK_DYLD_FALLBACK_LIBRARY_PATH=${DYLD_FALLBACK_LIBRARY_PATH}; fi'
++++ '[' -n '' ']'
+++ '[' -n '' ']'
+++ _sp_flags=
+++ '[' '!' -z x ']'
+++ '[' -print-shell-vars '!=' --print-shell-vars ']'
+++ _sp_flags=' --print-shell-vars'
+++ shift
+++ '[' '!' -z x ']'
+++ '[' sh,modules '!=' sh,modules ']'
+++ '[' -n ' --print-shell-vars' ']'
+++ '[' ell-vars '!=' ' --print-shell-vars' ']'
+++ command spack --print-shell-vars sh,modules
+++ return
+++ return 0
++ eval '_sp_sys_type='\''linux-rocky9-neoverse_v1'\''' '_sp_compatible_sys_types='\''linux-rocky9-neoverse_v1:linux-rocky9-neoverse_n1:linux-rocky9-armv8.4a:linux-rocky9-cortex_a72:linux-rocky9-armv8.2a:linux-rocky9-aarch64:linux-rocky9-armv8.1a:linux-rocky9-armv8.3a'\''' '_sp_tcl_roots='\''/opt/spack/share/spack/modules'\''' '_sp_lmod_roots='\''/opt/spack/share/spack/lmod'\''' '_sp_module_prefix='\''not_installed'\'''
+++ _sp_sys_type=linux-rocky9-neoverse_v1
+++ _sp_compatible_sys_types=linux-rocky9-neoverse_v1:linux-rocky9-neoverse_n1:linux-rocky9-armv8.4a:linux-rocky9-cortex_a72:linux-rocky9-armv8.2a:linux-rocky9-aarch64:linux-rocky9-armv8.1a:linux-rocky9-armv8.3a
+++ _sp_tcl_roots=/opt/spack/share/spack/modules
+++ _sp_lmod_roots=/opt/spack/share/spack/lmod
+++ _sp_module_prefix=not_installed
++ '[' not_installed '!=' not_installed ']'
++ _sp_multi_pathadd MODULEPATH /opt/spack/share/spack/modules
++ local IFS=:
++ '[' bash = zsh ']'
++ for pth in $2
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-neoverse_v1
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-neoverse_v1 ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-neoverse_v1
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-neoverse_v1 ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-neoverse_n1
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-neoverse_n1 ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-neoverse_n1
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-neoverse_n1 ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-armv8.4a
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-armv8.4a ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-armv8.4a
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-armv8.4a ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-cortex_a72
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-cortex_a72 ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-cortex_a72
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-cortex_a72 ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-armv8.2a
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-armv8.2a ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-armv8.2a
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-armv8.2a ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-aarch64
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-aarch64 ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-aarch64
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-aarch64 ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-armv8.1a
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-armv8.1a ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-armv8.1a
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-armv8.1a ']'
++ for systype in ${_sp_compatible_sys_types}
++ _spack_pathadd MODULEPATH /opt/spack/share/spack/modules/linux-rocky9-armv8.3a
++ _pa_varname=PATH
++ _pa_new_path=MODULEPATH
++ '[' -n /opt/spack/share/spack/modules/linux-rocky9-armv8.3a ']'
++ _pa_varname=MODULEPATH
++ _pa_new_path=/opt/spack/share/spack/modules/linux-rocky9-armv8.3a
++ eval '_pa_oldvalue=${MODULEPATH:-}'
+++ _pa_oldvalue=
++ _pa_canonical=:
++ '[' -d /opt/spack/share/spack/modules/linux-rocky9-armv8.3a ']'
++ test bash = bash
++ source /opt/spack/share/spack/spack-completion.bash
+++ test -n ''
+++ complete -o bashdefault -o default -F _bash_completion_spack spack
+++ complete -o bashdefault -o default -F _bash_completion_spack spacktivate
+++ SPACK_ALIASES='concretise:concretize;containerise:containerize;rm:remove'
++ unset _sp_initializing
++ export _sp_initializing
+ source /opt/llm/bin/activate
++ deactivate nondestructive
++ '[' -n '' ']'
++ '[' -n '' ']'
++ '[' -n /bin/sh -o -n '' ']'
++ hash -r
++ '[' -n '' ']'
++ unset VIRTUAL_ENV
++ '[' '!' nondestructive = nondestructive ']'
++ VIRTUAL_ENV=/opt/llm
++ export VIRTUAL_ENV
++ _OLD_VIRTUAL_PATH=/opt/spack/bin:/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/llm/bin:/opt/spack/bin:/opt/spack/var/spack/environments/virtual_fugaku/.spack-env/view/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/gcc-8.5.0/gcc-14.1.0-by7ibhprouon776fcsagfzmqm6enng6a/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/binutils-2.43.1-fdfvs5e4qnizssn3iycvkbrdyb2wbgav/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/zstd-1.5.6-ahkihqzppmjytclcgjgvg4ryjozjfkym/bin:/opt/spack/opt/spack/linux-rocky9-neoverse_v1/clang-18.1.8/gcc-8.5.0-57d2qb2hiayjz3lpijydghglbq6dvozy/bin:/opt/spack/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export PATH
++ '[' -n '' ']'
++ '[' -z '' ']'
++ _OLD_VIRTUAL_PS1=
++ PS1='(llm) '
++ export PS1
++ '[' -n /bin/sh -o -n '' ']'
++ hash -r
+ cd /opt
+ git clone https://github.com/microsoft/Megatron-DeepSpeed
Cloning into 'Megatron-DeepSpeed'...
+ cd Megatron-DeepSpeed
+ cat
+ pip install -r requirements.txt
Collecting deepspeed
  Downloading deepspeed-0.16.3.tar.gz (1.4 MB)
Requirement already satisfied: ninja in /opt/llm/lib/python3.9/site-packages (from -r requirements.txt (line 2)) (1.11.1.3)
Requirement already satisfied: numpy in /opt/llm/lib/python3.9/site-packages (from -r requirements.txt (line 3)) (2.0.2)
Requirement already satisfied: packaging in /opt/llm/lib/python3.9/site-packages (from -r requirements.txt (line 4)) (24.2)
Collecting pybind11
  Downloading pybind11-2.13.6-py3-none-any.whl (243 kB)
Collecting regex
  Downloading regex-2024.11.6-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (782 kB)
Requirement already satisfied: six in /opt/llm/lib/python3.9/site-packages (from -r requirements.txt (line 7)) (1.17.0)
Collecting tensorboard
  Downloading tensorboard-2.19.0-py3-none-any.whl (5.5 MB)
Requirement already satisfied: torch in /opt/pytorch (from -r requirements.txt (line 9)) (2.5.0a0+git32f585d)
Collecting transformers
  Downloading transformers-4.49.0-py3-none-any.whl (10.0 MB)
Collecting wandb
  Downloading wandb-0.19.6-py3-none-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (19.5 MB)
Requirement already satisfied: wheel in /opt/llm/lib/python3.9/site-packages (from -r requirements.txt (line 12)) (0.45.1)
Collecting mpi4py
  Downloading mpi4py-4.0.3.tar.gz (466 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Installing backend dependencies: started
  Installing backend dependencies: finished with status 'done'
    Preparing wheel metadata: started
    Preparing wheel metadata: finished with status 'done'
Collecting einops
  Downloading einops-0.8.1-py3-none-any.whl (64 kB)
Collecting hjson
  Downloading hjson-3.1.0-py3-none-any.whl (54 kB)
Collecting msgpack
  Downloading msgpack-1.1.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (371 kB)
Requirement already satisfied: psutil in /opt/llm/lib/python3.9/site-packages (from deepspeed->-r requirements.txt (line 1)) (7.0.0)
Collecting py-cpuinfo
  Downloading py_cpuinfo-9.0.0-py3-none-any.whl (22 kB)
Collecting pydantic>=2.0.0
  Downloading pydantic-2.10.6-py3-none-any.whl (431 kB)
Collecting tqdm
  Downloading tqdm-4.67.1-py3-none-any.whl (78 kB)
Requirement already satisfied: setuptools>=41.0.0 in /opt/llm/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 8)) (53.0.0)
Collecting absl-py>=0.4
  Downloading absl_py-2.1.0-py3-none-any.whl (133 kB)
Collecting markdown>=2.6.8
  Downloading Markdown-3.7-py3-none-any.whl (106 kB)
Collecting protobuf!=4.24.0,>=3.19.6
  Downloading protobuf-5.29.3-cp38-abi3-manylinux2014_aarch64.whl (319 kB)
Collecting tensorboard-data-server<0.8.0,>=0.7.0
  Downloading tensorboard_data_server-0.7.2-py3-none-any.whl (2.4 kB)
Collecting werkzeug>=1.0.1
  Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)
Collecting grpcio>=1.48.2
  Downloading grpcio-1.70.0-cp39-cp39-manylinux_2_17_aarch64.whl (5.7 MB)
Requirement already satisfied: filelock in /opt/llm/lib/python3.9/site-packages (from torch->-r requirements.txt (line 9)) (3.17.0)
Requirement already satisfied: typing-extensions>=4.8.0 in /opt/llm/lib/python3.9/site-packages (from torch->-r requirements.txt (line 9)) (4.12.2)
Requirement already satisfied: networkx in /opt/llm/lib/python3.9/site-packages (from torch->-r requirements.txt (line 9)) (3.2.1)
Requirement already satisfied: jinja2 in /opt/llm/lib/python3.9/site-packages (from torch->-r requirements.txt (line 9)) (3.1.5)
Requirement already satisfied: fsspec in /opt/llm/lib/python3.9/site-packages (from torch->-r requirements.txt (line 9)) (2025.2.0)
Collecting sympy==1.13.1
  Downloading sympy-1.13.1-py3-none-any.whl (6.2 MB)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/llm/lib/python3.9/site-packages (from sympy==1.13.1->torch->-r requirements.txt (line 9)) (1.3.0)
Collecting tokenizers<0.22,>=0.21
  Downloading tokenizers-0.21.0-cp39-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (2.9 MB)
Collecting safetensors>=0.4.1
  Downloading safetensors-0.5.2-cp38-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (450 kB)
Collecting huggingface-hub<1.0,>=0.26.0
  Downloading huggingface_hub-0.29.1-py3-none-any.whl (468 kB)
Requirement already satisfied: requests in /opt/llm/lib/python3.9/site-packages (from transformers->-r requirements.txt (line 10)) (2.32.3)
Requirement already satisfied: pyyaml>=5.1 in /opt/llm/lib/python3.9/site-packages (from transformers->-r requirements.txt (line 10)) (6.0.2)
Collecting docker-pycreds>=0.4.0
  Downloading docker_pycreds-0.4.0-py2.py3-none-any.whl (9.0 kB)
Collecting eval-type-backport
  Downloading eval_type_backport-0.2.2-py3-none-any.whl (5.8 kB)
Collecting platformdirs
  Downloading platformdirs-4.3.6-py3-none-any.whl (18 kB)
Collecting setproctitle
  Downloading setproctitle-1.3.4-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (30 kB)
Collecting gitpython!=3.1.29,>=1.0.0
  Downloading GitPython-3.1.44-py3-none-any.whl (207 kB)
Collecting sentry-sdk>=2.0.0
  Downloading sentry_sdk-2.22.0-py2.py3-none-any.whl (325 kB)
Collecting click!=8.0.0,>=7.1
  Downloading click-8.1.8-py3-none-any.whl (98 kB)
Collecting gitdb<5,>=4.0.1
  Downloading gitdb-4.0.12-py3-none-any.whl (62 kB)
Collecting smmap<6,>=3.0.1
  Downloading smmap-5.0.2-py3-none-any.whl (24 kB)
Collecting importlib-metadata>=4.4
  Using cached importlib_metadata-8.6.1-py3-none-any.whl (26 kB)
Collecting zipp>=3.20
  Using cached zipp-3.21.0-py3-none-any.whl (9.6 kB)
Collecting pydantic-core==2.27.2
  Downloading pydantic_core-2.27.2-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (1.8 MB)
Collecting annotated-types>=0.6.0
  Downloading annotated_types-0.7.0-py3-none-any.whl (13 kB)
Requirement already satisfied: idna<4,>=2.5 in /opt/llm/lib/python3.9/site-packages (from requests->transformers->-r requirements.txt (line 10)) (3.10)
Requirement already satisfied: certifi>=2017.4.17 in /opt/llm/lib/python3.9/site-packages (from requests->transformers->-r requirements.txt (line 10)) (2025.1.31)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/llm/lib/python3.9/site-packages (from requests->transformers->-r requirements.txt (line 10)) (2.3.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/llm/lib/python3.9/site-packages (from requests->transformers->-r requirements.txt (line 10)) (3.4.1)
Requirement already satisfied: MarkupSafe>=2.1.1 in /opt/llm/lib/python3.9/site-packages (from werkzeug>=1.0.1->tensorboard->-r requirements.txt (line 8)) (3.0.2)
Building wheels for collected packages: deepspeed, mpi4py
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.16.3-py3-none-any.whl size=1549938 sha256=e07ce380ef1383c6c1b035affcefed2fc71a770670d9a4b247524f49d01b0768
  Stored in directory: /root/.cache/pip/wheels/80/7d/5c/ba8d8aa95d5696c63fe6491b72dcc9e4906d8f0622252c8901
  Building wheel for mpi4py (PEP 517): started
  Building wheel for mpi4py (PEP 517): still running...
  Building wheel for mpi4py (PEP 517): finished with status 'done'
  Created wheel for mpi4py: filename=mpi4py-4.0.3-cp39-cp39-linux_aarch64.whl size=4532935 sha256=2786807fa1d7f4dd45b53bcaa2144c29449fb2f824329c4eec0ba052696b59f0
  Stored in directory: /root/.cache/pip/wheels/c8/6d/35/5b437fa28e579de9da97d3894b2ce58cf12b6e3baf4c85d827
Successfully built deepspeed mpi4py
Installing collected packages: zipp, tqdm, smmap, sympy, pydantic-core, importlib-metadata, huggingface-hub, gitdb, annotated-types, werkzeug, tokenizers, tensorboard-data-server, setproctitle, sentry-sdk, safetensors, regex, pydantic, py-cpuinfo, protobuf, platformdirs, msgpack, markdown, hjson, grpcio, gitpython, eval-type-backport, einops, docker-pycreds, click, absl-py, wandb, transformers, tensorboard, pybind11, mpi4py, deepspeed
  Attempting uninstall: sympy
    Found existing installation: sympy 1.13.3
    Uninstalling sympy-1.13.3:
      Successfully uninstalled sympy-1.13.3
Successfully installed absl-py-2.1.0 annotated-types-0.7.0 click-8.1.8 deepspeed-0.16.3 docker-pycreds-0.4.0 einops-0.8.1 eval-type-backport-0.2.2 gitdb-4.0.12 gitpython-3.1.44 grpcio-1.70.0 hjson-3.1.0 huggingface-hub-0.29.1 importlib-metadata-8.6.1 markdown-3.7 mpi4py-4.0.3 msgpack-1.1.0 platformdirs-4.3.6 protobuf-5.29.3 py-cpuinfo-9.0.0 pybind11-2.13.6 pydantic-2.10.6 pydantic-core-2.27.2 regex-2024.11.6 safetensors-0.5.2 sentry-sdk-2.22.0 setproctitle-1.3.4 smmap-5.0.2 sympy-1.13.1 tensorboard-2.19.0 tensorboard-data-server-0.7.2 tokenizers-0.21.0 tqdm-4.67.1 transformers-4.49.0 wandb-0.19.6 werkzeug-3.1.3 zipp-3.21.0
WARNING: You are using pip version 21.2.3; however, version 25.0.1 is available.
You should consider upgrading via the '/opt/llm/bin/python3 -m pip install --upgrade pip' command.
+ pip list
Package                 Version            Location
----------------------- ------------------ --------------
absl-py                 2.1.0
annotated-types         0.7.0
astunparse              1.6.3
attrs                   25.1.0
certifi                 2025.1.31
charset-normalizer      3.4.1
click                   8.1.8
cmake                   3.31.4
deepspeed               0.16.3
docker-pycreds          0.4.0
einops                  0.8.1
eval_type_backport      0.2.2
exceptiongroup          1.2.2
expecttest              0.3.0
filelock                3.17.0
fsspec                  2025.2.0
gitdb                   4.0.12
GitPython               3.1.44
grpcio                  1.70.0
hjson                   3.1.0
huggingface-hub         0.29.1
hypothesis              6.126.0
idna                    3.10
importlib_metadata      8.6.1
Jinja2                  3.1.5
lintrunner              0.12.7
Markdown                3.7
MarkupSafe              3.0.2
mpi4py                  4.0.3
mpmath                  1.3.0
msgpack                 1.1.0
networkx                3.2.1
ninja                   1.11.1.3
numpy                   2.0.2
optree                  0.14.0
packaging               24.2
pillow                  11.1.0
pip                     21.2.3
platformdirs            4.3.6
protobuf                5.29.3
psutil                  7.0.0
py-cpuinfo              9.0.0
pybind11                2.13.6
pydantic                2.10.6
pydantic_core           2.27.2
PyYAML                  6.0.2
regex                   2024.11.6
requests                2.32.3
safetensors             0.5.2
sentry-sdk              2.22.0
setproctitle            1.3.4
setuptools              53.0.0
six                     1.17.0
smmap                   5.0.2
sortedcontainers        2.4.0
sympy                   1.13.1
tensorboard             2.19.0
tensorboard-data-server 0.7.2
tokenizers              0.21.0
torch                   2.5.0a0+git32f585d /opt/pytorch
torchaudio              2.6.0a0+c670ad8    /opt/audio/src
torchvision             0.22.0a0+b5c7443   /opt/vision
tqdm                    4.67.1
transformers            4.49.0
types-dataclasses       0.6.6
typing_extensions       4.12.2
urllib3                 2.3.0
wandb                   0.19.6
Werkzeug                3.1.3
wheel                   0.45.1
zipp                    3.21.0
WARNING: You are using pip version 21.2.3; however, version 25.0.1 is available.
You should consider upgrading via the '/opt/llm/bin/python3 -m pip install --upgrade pip' command.
+ cd /opt/Megatron-DeepSpeed/megatron/data/
+ make
g++ -O3 -Wall -shared -std=c++11 -fPIC -fdiagnostics-color -I/usr/include/python3.9 -I/opt/llm/lib64/python3.9/site-packages/pybind11/include helpers.cpp -o helpers.cpython-39-aarch64-linux-gnu.so
INFO:    Adding environment to container
INFO:    Adding runscript
INFO:    Creating SIF file...
VERBOSE: Set SIF container architecture to arm64
VERBOSE: Build complete: /lustre01/rccs-sdt/a01029/work/singularity/Megatron-DeepSpeed2/Megatron-DeepSpeed.sif
INFO:    Build complete: Megatron-DeepSpeed.sif
